<!DOCTYPE html>
<html>
	<head>
		<meta charset="utf-8">
		<style>

		
		.hexagon {
		  
		  stroke: #000;
		  stroke-width: 0.3px;
		}

		</style>
		<script src="ext_lib/d3.v3.min.js"></script>
		<script src="myHex.js"></script>
		<script src="Hexgenerator.js"></script>
		<script src="ext_lib/Alea.js"></script>
		<script src="ext_lib/simplex-noise.min.js"></script>
		<script src="ext_lib/three.min.js"></script>
		<script src="ext_lib/NURBSSurface.js"></script>
		<script src="ext_lib/NURBSUtils.js"></script>
		<script src="ext_lib/socket.io/socket.io.js"></script>
		<script>
		var params=new Object();

		var tmp=window.location.search.substr(1).split("&");
		for (i=0; i<tmp.length; i++)
		{
			data=tmp[i].split("=");
			params[data[0]]=data[1];		
		}
		var socket = io.connect();
		socket.on('data', function (data) {
		var margin = {top: 20, right: 20, bottom: 30, left: 40},
		width = 960 - margin.left - margin.right,
		height = 500 - margin.top - margin.bottom;
		
		delta={q:42,r:108}
			
		data=generateMap(params.size||50,params.seed||Math.random(),params.patch||20,0.05,delta);
			
			
			var i=0;
			var points = [];
			for (hex in data) 
			  points[i++]=data[hex];
			
			var radius = 3;

			var hexbin = d3.hexbin()
				.size([width, height])
				.radius(radius);

			var svg = d3.select("body").append("svg")
				.attr("width", "200%")
				.attr("height", "200%")
			  .append("g")
				.attr("transform", "translate(" + margin.left + "," + margin.top + ")");

			svg.append("g")
				.selectAll(".hexagon")
				.data(hexbin(points))
			  .enter().append("path")
				.attr("class", "hexagon")
				.attr("d", function(d) { return hexbin.hexagon(); })
				.attr("transform", function(d) { return "translate("+ (10+ d.x) + ","+ (10+ d.y) + ")"; })
				.on("mouseover", function(d){d3.select(this).style("fill", "black");})
				.on("mouseout", function(d){d3.select(this).style("fill", d.fill);});
				d3.selectAll('path')
				.attr('fill', function(d){return d.fill;})
				.on("click", function(d){alert(d.name);});
		  });
		</script>
	</head>
	<body>
		
    </body>
</html>